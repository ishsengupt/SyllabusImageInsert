{"ast":null,"code":"var _jsxFileName = \"/Users/shanengupta/Desktop/react-ocr/src/components/LinkList.js\";\nimport React from \"react\";\nimport FirebaseContext from \"/../firebase/context\";\nimport { LINKS_PER_PAGE } from \"../../utils/index\";\nimport axios from \"axios\";\nimport { Link, withRouter, NavLink } from \"react-router-dom\";\n\nfunction LinkList(props) {\n  const {\n    firebase\n  } = React.useContext(FirebaseContext);\n  const [links, setLinks] = React.useState([]);\n  const [cursor, setCursor] = React.useState(null);\n  const [loading, setLoading] = React.useState(false);\n  const [cats, setCats] = React.useState([]);\n  const [featured, setFeatured] = React.useState([]);\n  const isNewPage = props.location.pathname.includes(\"new\");\n  const isTopPage = props.location.pathname.includes(\"top\");\n  const page = Number(props.match.params.page);\n  const linksRef = firebase.db.collection(\"syllabus\");\n  React.useEffect(() => {\n    const unsubscribe = getLinks();\n    return () => unsubscribe();\n  }, [isTopPage, page]);\n\n  function getLinks() {\n    const hasCursor = Boolean(cursor);\n    setLoading(true);\n\n    if (isTopPage) {\n      return linksRef.orderBy(\"voteCount\", \"desc\").limit(LINKS_PER_PAGE).onSnapshot(handleSnapshot);\n    } else if (page === 1) {\n      return linksRef.orderBy(\"created\", \"desc\").limit(LINKS_PER_PAGE).onSnapshot(handleSnapshot);\n    } else if (hasCursor) {\n      return linksRef.orderBy(\"created\", \"desc\").startAfter(cursor.created).limit(LINKS_PER_PAGE).onSnapshot(handleSnapshot);\n    } else {\n      const offset = page * LINKS_PER_PAGE - LINKS_PER_PAGE;\n      axios.get(`https://us-central1-hooks-news-app-1a459.cloudfunctions.net/linksPagination?offset=${offset}`).then(response => {\n        const links = response.data;\n        const lastLink = links[links.length - 1];\n        setLinks(links);\n        setCursor(lastLink);\n        setLoading(false);\n      });\n      return () => {};\n    }\n  }\n\n  function handleSnapshot(snapshot) {\n    const links = snapshot.docs.map(doc => {\n      return {\n        id: doc.id,\n        ...doc.data()\n      };\n    });\n    const lastLink = links[links.length - 1];\n    setLinks(links);\n    setCursor(lastLink);\n    setLoading(false);\n  }\n\n  function visitPreviousPage() {\n    if (page > 1) {\n      props.history.push(`/new/${page - 1}`);\n    }\n  }\n\n  function visitNextPage() {\n    if (page <= links.length / LINKS_PER_PAGE) {\n      props.history.push(`/new/${page + 1}`);\n    }\n  }\n\n  const pageIndex = page ? (page - 1) * LINKS_PER_PAGE + 1 : 0;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"list__grid\",\n    style: {\n      opacity: loading ? 0.25 : 1\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"main__items\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }\n  }, links.map((link, index) => /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 11\n    }\n  }, \"this\"))));\n}\n\nexport default withRouter(LinkList);","map":{"version":3,"sources":["/Users/shanengupta/Desktop/react-ocr/src/components/LinkList.js"],"names":["React","FirebaseContext","LINKS_PER_PAGE","axios","Link","withRouter","NavLink","LinkList","props","firebase","useContext","links","setLinks","useState","cursor","setCursor","loading","setLoading","cats","setCats","featured","setFeatured","isNewPage","location","pathname","includes","isTopPage","page","Number","match","params","linksRef","db","collection","useEffect","unsubscribe","getLinks","hasCursor","Boolean","orderBy","limit","onSnapshot","handleSnapshot","startAfter","created","offset","get","then","response","data","lastLink","length","snapshot","docs","map","doc","id","visitPreviousPage","history","push","visitNextPage","pageIndex","opacity","link","index"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport FirebaseContext from \"/../firebase/context\";\n\nimport { LINKS_PER_PAGE } from \"../../utils/index\";\nimport axios from \"axios\";\nimport { Link, withRouter, NavLink } from \"react-router-dom\";\n\nfunction LinkList(props) {\n  const { firebase } = React.useContext(FirebaseContext);\n  const [links, setLinks] = React.useState([]);\n  const [cursor, setCursor] = React.useState(null);\n  const [loading, setLoading] = React.useState(false);\n  const [cats, setCats] = React.useState([]);\n  const [featured, setFeatured] = React.useState([]);\n  const isNewPage = props.location.pathname.includes(\"new\");\n  const isTopPage = props.location.pathname.includes(\"top\");\n  const page = Number(props.match.params.page);\n  const linksRef = firebase.db.collection(\"syllabus\");\n\n  React.useEffect(() => {\n    const unsubscribe = getLinks();\n    return () => unsubscribe();\n  }, [isTopPage, page]);\n\n  function getLinks() {\n    const hasCursor = Boolean(cursor);\n    setLoading(true);\n    if (isTopPage) {\n      return linksRef\n        .orderBy(\"voteCount\", \"desc\")\n        .limit(LINKS_PER_PAGE)\n        .onSnapshot(handleSnapshot);\n    } else if (page === 1) {\n      return linksRef\n        .orderBy(\"created\", \"desc\")\n        .limit(LINKS_PER_PAGE)\n        .onSnapshot(handleSnapshot);\n    } else if (hasCursor) {\n      return linksRef\n        .orderBy(\"created\", \"desc\")\n        .startAfter(cursor.created)\n        .limit(LINKS_PER_PAGE)\n        .onSnapshot(handleSnapshot);\n    } else {\n      const offset = page * LINKS_PER_PAGE - LINKS_PER_PAGE;\n      axios\n        .get(\n          `https://us-central1-hooks-news-app-1a459.cloudfunctions.net/linksPagination?offset=${offset}`\n        )\n        .then(response => {\n          const links = response.data;\n          const lastLink = links[links.length - 1];\n          setLinks(links);\n          setCursor(lastLink);\n          setLoading(false);\n        });\n      return () => {};\n    }\n  }\n\n  function handleSnapshot(snapshot) {\n    const links = snapshot.docs.map(doc => {\n      return { id: doc.id, ...doc.data() };\n    });\n    const lastLink = links[links.length - 1];\n    setLinks(links);\n    setCursor(lastLink);\n    setLoading(false);\n  }\n\n  function visitPreviousPage() {\n    if (page > 1) {\n      props.history.push(`/new/${page - 1}`);\n    }\n  }\n\n  function visitNextPage() {\n    if (page <= links.length / LINKS_PER_PAGE) {\n      props.history.push(`/new/${page + 1}`);\n    }\n  }\n\n  const pageIndex = page ? (page - 1) * LINKS_PER_PAGE + 1 : 0;\n\n  return (\n    <div className=\"list__grid\" style={{ opacity: loading ? 0.25 : 1 }}>\n      <div className=\"main__items\">\n        {links.map((link, index) => (\n          <div>this</div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default withRouter(LinkList);\n"]},"metadata":{},"sourceType":"module"}